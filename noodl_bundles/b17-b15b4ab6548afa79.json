[{"name":"/#OAuth redirect/OAuth","nodes":[{"id":"4770cc14-b2d6-fa7f-8fec-cb546f6c6f01","type":"Page","parameters":{"paddingTop":{"value":24,"unit":"px"}},"ports":[],"children":[{"id":"9d25301a-0120-1324-b668-42f62b8a72ad","type":"Text","parameters":{"text":"Logged in successfully!","sizeMode":"contentSize","alignX":"center"},"ports":[],"children":[]},{"id":"aa964bed-47bb-5b64-bec7-399341f31a94","type":"Text","parameters":{"text":"Failed login","sizeMode":"contentSize","alignX":"center"},"ports":[],"children":[]},{"id":"1873cb74-d50a-2618-8829-2c1ceacf5094","type":"net.noodl.controls.button","parameters":{"label":"Return to posts","alignX":"center","marginTop":{"value":19,"unit":"px"}},"ports":[],"children":[]}]},{"id":"ab08d2c5-f163-5e45-f014-3b391444f5e5","type":"PageInputs","parameters":{"queryParams":"code"},"ports":[],"children":[]},{"id":"bc67223b-f5f5-53ef-ee91-e82de0e5d001","type":"/OAuth2/Log In","parameters":{},"ports":[],"children":[]},{"id":"cbff35fb-f41a-88c2-a76e-8744414ce0f1","type":"States","parameters":{"states":"Neutral,Successful login,Failed login"},"ports":[],"children":[]},{"id":"6a52bbe8-3cb1-c225-e3c4-15e84c5acf45","type":"RouterNavigate","parameters":{"router":"main","target":"/#Posts/Posts"},"ports":[],"children":[]},{"id":"3644cf56-21a5-48f3-0c34-d9fe4126a2c3","type":"net.noodl.user.User","parameters":{},"ports":[],"children":[]},{"id":"7c0a80a9-4f24-b656-ceb9-217e7fb7dc7a","type":"net.noodl.user.SetUserProperties","parameters":{},"ports":[],"children":[]},{"id":"391737fa-8a0d-e579-c086-fa64a84ef35f","type":"REST2","parameters":{"resource":"https://api.spotify.com/v1/me","requestScript":"//Add custom code to setup the request object before the request\n//is made.\n//\n//*Request.resource     contains the resource path of the request.\n//*Request.method       contains the method, GET, POST, PUT or DELETE.\n//*Request.headers      is a map where you can add additional headers.\n//*Request.parameters   is a map the parameters that will be appended\n//                      to the url.\n//*Request.content      contains the content of the request as a javascript\n//                      object.\n//\n\nRequest.headers['Authorization'] = \"Bearer \"+Inputs.token;\nRequest.headers['Content-Type'] = \"application/json\";","responseScript":"// Add custom code to convert the response content to outputs\n//\n//*Response.status    The status code of the response\n//*Response.content   The content of the response as a javascript\n//                    object.\n//*Response.request   The request object that resulted in the response.\n//\n//*Inputs and *Outputs contain the inputs and outputs of the node.\n\nlet images = Response.content.images;\nOutputs.UserImage = images[0].url;"},"ports":[],"children":[]},{"id":"07894c98-a5e1-847a-0f39-2f2bf5cb50b1","type":"net.noodl.user.SetUserProperties","parameters":{},"ports":[],"children":[]},{"id":"5e08d28c-33ad-9e92-f10f-166f7605d477","type":"Set Variable","parameters":{"name":"spotify_token","setWith":"string"},"ports":[],"children":[]}],"connections":[{"sourceId":"ab08d2c5-f163-5e45-f014-3b391444f5e5","sourcePort":"pm-code","targetId":"bc67223b-f5f5-53ef-ee91-e82de0e5d001","targetPort":"Code"},{"sourceId":"4770cc14-b2d6-fa7f-8fec-cb546f6c6f01","sourcePort":"didMount","targetId":"bc67223b-f5f5-53ef-ee91-e82de0e5d001","targetPort":"Do"},{"sourceId":"bc67223b-f5f5-53ef-ee91-e82de0e5d001","sourcePort":"Failure","targetId":"cbff35fb-f41a-88c2-a76e-8744414ce0f1","targetPort":"to-Failed login"},{"sourceId":"bc67223b-f5f5-53ef-ee91-e82de0e5d001","sourcePort":"Success","targetId":"cbff35fb-f41a-88c2-a76e-8744414ce0f1","targetPort":"to-Successful login"},{"sourceId":"cbff35fb-f41a-88c2-a76e-8744414ce0f1","sourcePort":"at-Successful login","targetId":"9d25301a-0120-1324-b668-42f62b8a72ad","targetPort":"mounted"},{"sourceId":"cbff35fb-f41a-88c2-a76e-8744414ce0f1","sourcePort":"at-Failed login","targetId":"aa964bed-47bb-5b64-bec7-399341f31a94","targetPort":"mounted"},{"sourceId":"1873cb74-d50a-2618-8829-2c1ceacf5094","sourcePort":"onClick","targetId":"6a52bbe8-3cb1-c225-e3c4-15e84c5acf45","targetPort":"navigate"},{"sourceId":"bc67223b-f5f5-53ef-ee91-e82de0e5d001","sourcePort":"Success","targetId":"7c0a80a9-4f24-b656-ceb9-217e7fb7dc7a","targetPort":"store"},{"sourceId":"bc67223b-f5f5-53ef-ee91-e82de0e5d001","sourcePort":"Spotify Token","targetId":"391737fa-8a0d-e579-c086-fa64a84ef35f","targetPort":"in-token"},{"sourceId":"391737fa-8a0d-e579-c086-fa64a84ef35f","sourcePort":"success","targetId":"07894c98-a5e1-847a-0f39-2f2bf5cb50b1","targetPort":"store"},{"sourceId":"bc67223b-f5f5-53ef-ee91-e82de0e5d001","sourcePort":"Spotify Token","targetId":"5e08d28c-33ad-9e92-f10f-166f7605d477","targetPort":"value"},{"sourceId":"7c0a80a9-4f24-b656-ceb9-217e7fb7dc7a","sourcePort":"success","targetId":"5e08d28c-33ad-9e92-f10f-166f7605d477","targetPort":"do"},{"sourceId":"5e08d28c-33ad-9e92-f10f-166f7605d477","sourcePort":"done","targetId":"391737fa-8a0d-e579-c086-fa64a84ef35f","targetPort":"fetch"}],"ports":[],"roots":["4770cc14-b2d6-fa7f-8fec-cb546f6c6f01"]},{"name":"/OAuth2/Log In","nodes":[{"id":"ee6cafe2-7710-ed93-03eb-31b7524c0715","type":"Component Inputs","parameters":{},"ports":[],"children":[]},{"id":"a62cb9d3-fba3-8348-e808-da8da2866fa6","type":"Component Outputs","parameters":{},"ports":[],"children":[]},{"id":"1ef4832b-1a0a-be53-fd87-57fd63b1b440","type":"CloudFunction2","parameters":{"function":"OAuth2/Log In"},"ports":[],"children":[]},{"id":"3decfab8-d511-4f4a-7512-4dedb2a2ae11","type":"JavaScriptFunction","parameters":{"functionScript":"try {\n    await Noodl.Users.become(Inputs.SessionToken)\n}\ncatch(e) {\n    Outputs.Failure()\n    throw e;\n}\n\nOutputs.Success()"},"ports":[{"name":"in-SessionToken","displayName":"SessionToken","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":6}],"children":[]}],"connections":[{"sourceId":"1ef4832b-1a0a-be53-fd87-57fd63b1b440","sourcePort":"success","targetId":"3decfab8-d511-4f4a-7512-4dedb2a2ae11","targetPort":"run"},{"sourceId":"1ef4832b-1a0a-be53-fd87-57fd63b1b440","sourcePort":"out-Session Token","targetId":"3decfab8-d511-4f4a-7512-4dedb2a2ae11","targetPort":"in-SessionToken"},{"sourceId":"ee6cafe2-7710-ed93-03eb-31b7524c0715","sourcePort":"Code","targetId":"1ef4832b-1a0a-be53-fd87-57fd63b1b440","targetPort":"in-Code"},{"sourceId":"ee6cafe2-7710-ed93-03eb-31b7524c0715","sourcePort":"Do","targetId":"1ef4832b-1a0a-be53-fd87-57fd63b1b440","targetPort":"call"},{"sourceId":"3decfab8-d511-4f4a-7512-4dedb2a2ae11","sourcePort":"out-Failure","targetId":"a62cb9d3-fba3-8348-e808-da8da2866fa6","targetPort":"Failure"},{"sourceId":"3decfab8-d511-4f4a-7512-4dedb2a2ae11","sourcePort":"out-Success","targetId":"a62cb9d3-fba3-8348-e808-da8da2866fa6","targetPort":"Success"},{"sourceId":"1ef4832b-1a0a-be53-fd87-57fd63b1b440","sourcePort":"failure","targetId":"a62cb9d3-fba3-8348-e808-da8da2866fa6","targetPort":"Failure"},{"sourceId":"1ef4832b-1a0a-be53-fd87-57fd63b1b440","sourcePort":"out-Spotify Token","targetId":"a62cb9d3-fba3-8348-e808-da8da2866fa6","targetPort":"Spotify Token"}],"ports":[{"name":"Success","type":"signal","plug":"output","index":0},{"name":"Do","type":{"name":"signal","allowConnectionsOnly":true},"group":"Actions","plug":"input","index":0},{"name":"Failure","type":{"name":"signal"},"plug":"output","index":1},{"name":"Code","type":"*","group":"Parameters","plug":"input","index":1},{"name":"Spotify Token","type":"*","plug":"output","index":2}],"roots":[]}]